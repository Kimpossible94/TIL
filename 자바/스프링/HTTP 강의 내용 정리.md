# 섹션 1
웹개발자라면 평생 HTTP 기반위에서 개발을 해야한다.  
그러니 언젠가 한번은 HTTP에 대해서 공부하고 정리를 해둬야한다.  

<br>

---
## 인터넷 통신
클라이언트와 서버가 같은 공간에 있다면 케이블을 연결해 메세지를 전달받을 수 있을 것이다.  
하지만, 서버와 클라이언트가 멀리 있다면 인터넷을 통해 메세지를 전달해야한다.  

인터넷을 통해 메세지를 전달하는 것은 단순하지 않다.  
무언가 복잡한 규칙을 통해서 메세지가 전달되는데, 그것을 **IP(인터넷 프로토콜)** 이라 한다.  

## IP(인터넷 프로토콜)의 역할
* 지정한 IP 주소(IP Address)에 데이터를 전달
* 패킷(Packet)이라는 통신 단위로 데이터 전달

메세지를 그냥 보내는 것이 아니라 IP 패킷을 이용해 보내는데  
<br>
<image style="width: 400px" src="https://github.com/Kimpossible94/TIL/assets/80395024/11e8aa1c-3113-43f5-a483-8000d7946a66"><br>
  
IP 패킷에는 출발지 IP(클라이언트의 IP 주소), 목적지 IP(서버 IP 주소), 메세지 등이 들어간다.  
그리고 이 패킷을 인터넷망에 던진다.  
  
<image style="width: 600px" src="https://github.com/Kimpossible94/TIL/assets/80395024/80663405-adcb-43c2-bbd1-b79c7a5788e3"><br>
  
이제 인터넷망의 노드들이 던져진 패킷의 목적지에 도달하기 위해 서로 데이터를 전달한다.  
<details>
<summary>노드란 ?</summary>

#### 노드에 대한 간략한 설명  
<image style="width: 600px" src="https://github.com/Kimpossible94/TIL/assets/80395024/ab6587ef-ea09-4b25-83a0-ddf1538585ce"><br>
네트워크는 컴퓨터와 네트워크 장비를 *유무선의 전송 매체*로 연결하여 데이터를 전송하는 시스템이다.  
복잡한 네트워크 시스템을 단순화하면 네트워크는 그림과 같이 *전송 매체라는 선(또는 링크, Link)* 과 *컴퓨터와 네트워크 장비라는 점*들이 그물망처럼 연결된 것을 말한다.  
선을 여러 방향으로 분기시키는 각각의 점들을 **노드(Node, 분기점)** 라고 한다.  
  
다시 말해 **일반적으로 네트워크에 연결된 모든 물리적인 기기 또는 장치를 노드**라고 한다.    
즉, 네트워크 상에서 데이터를 주고받을 수 있는 PC, 노트북, 스마트폰 같은 컴퓨터와 라우터, 인터넷 공유기 같은 네트워크 장비가 각각 하나의 노드이다.   
노드는 네트워크에서 데이터를 전송하기 위해 연결된 기기이기 때문에 데이터를 보내는 송신지 또는 데이터를 받는 수신지 역할을 한다.  
따라서, 우편물을 주고받기 위해 송신지와 수신지의 주소가 필요한 것처럼 데이터를 주고받는 노드에도 다른 노드와 구별할 수 있는 고유한 주소가 필요하다.
따라서, 다른 노드와 구별되는 고유한 주소를 갖고 있는 노드를 네트워크에 연결된 주소가 있는 물리적인 장치라고 정의하기도 한다.  
MAC 주소라는 고유한 물리 주소를 갖고 있는 컴퓨터와 라우터가 네트워크의 대표적인 노드이다.  
<a href="https://better-together.tistory.com/74">노드 내용 출처</a>
</details>  

이렇게 데이터를 전달하다보면 목적지에 도달하게 된다.  
<br>
<image style="width: 600px" src="https://github.com/Kimpossible94/TIL/assets/80395024/8aa1b25c-73b3-45b7-ab3f-112f0a3ea63d"><br>
  
이제 데이터를 받은 목적지에서 잘받았다는 OK라는 메세지를 담아서 다시 전달한다.  
그럼 다시 노드들이 데이터를 전달해서 메세지가 전달된다.  
  
## IP(인터넷 프로토콜)의 한계
1. 비연결성  
<image style="width: 600px" src="https://github.com/Kimpossible94/TIL/assets/80395024/376a4739-c2c6-4e3c-9a2a-88464ec1c515">
<br>

```
목적지에 있는 PC가 꺼진 상태여도 즉, 패킷을 받을 대상이 없거나
서비스 불능 상태여도 패킷이 전송된다는 문제가 있다.
클라이언트는 서버가 패킷을 받을 수 있는 상태인지 아닌지 모르기 때문에 패킷을 그냥 보내버린다.
```

2. 비신뢰성  
<image style="width: 600px" src="https://github.com/Kimpossible94/TIL/assets/80395024/c8a37014-b4e3-4e24-8e6d-395827cb0d9d">  
<image style="width: 600px" src="https://github.com/Kimpossible94/TIL/assets/80395024/948c06be-a9e8-45b6-90f6-468039225f69">
<br>

```
패킷의 용량이 크다면 패킷을 끊어서 보내는 데, 패킷을 여러개 보냈을 때 네트워크 지연등의 이유로
패킷이 순서대로 보내지지 않을 수 있다는 문제가 있다. 이런 문제가 생기면 데이터의 신뢰성이 떨어지게 된다.
또한, 중간에 있는 서버가 문제가 있거나 다른 문제로 인해 패킷이 소실이 되고 소실됬는지 알 수 없다.
그래서 도착한 패킷이 중간이 빠진 패킷인지 알 수 없기 때문에 마찬가지로 데이터의 신뢰성이 떨어진다.
```

이러한 문제를 해결하기 위한 것이 바로 **TCP, UDP** 이다.

---

<br>

---
## 인터넷 프로토콜 스택의 4계층  
![image](https://github.com/Kimpossible94/TIL/assets/80395024/62655dc4-bd93-4a37-ba6d-7a3a842b7aa0)  

~~~
4계층 : 애플리케이션 계층(Application Layer)  
사용자와 가장 가까운 계층으로, 사용자-소프트웨어 간 소통을 담당하는 계층이다.  
애플리케이션을 실행하기 위한 데이터 형식이 작성되는 계층이다.
프로토콜로는 HTTP, HTTPS, FTP, SSH, Telnet, DNS, SMTP 가 있다.
~~~
~~~
3계층 : 전송 계층(Transport Layer)
통신 노드 간 신뢰성 있는 데이터 전송을 보장하는 계층이다.
역캡슐화 과정에서, 포트 번호를 사용해 데이터를 정확한 애플리케이션에 전달하는 역할도 한다.
네트워크 액세스 계층과 인터넷 계층을 통해, 데이터가 목적지 기기까지 정상적으로 도착했다면,
전송 계층은 포트 번호를 사용해, 데이터를 목적지 기기 내 적절한 에플리케이션으로 전달한다.
프로토콜로는 TCP, UDP, RTP, RTCP 가 있다.
~~~
~~~
2계층 : 인터넷 계층(Internet Layer)
패킷을 최종 목적지까지 라우팅하는 계층이다.
프로토콜로는 IP, ARP, ICMP, RARP, OSPF 가 사용된다.
~~~

<details>
<summary>라우팅 ?</summary>
인터넷은 여러 네트워크의 연결로 구성되어있기 때문에 송신지에서 목적지까지 도달할 수 있는 경로가 여러개 있을 수 있다.
여기서 어느 하나의 올바른 경로를 선택하는 것이 라우팅(경로설정)이라 한다.
</details>  

~~~
1계층 : 네트워크 액세스 계층(Network Access Layer or Network Interface Layer)
데이터를 전기신호로 변환한 뒤, 물리적 주소인 MAC 주소를 사용해, 알맞은 기기로 데이터를 전달하는 계층이다.
프로토콜로는 Ethernet, Wi-Fi, PPP, Token Ring 과 같은 프로토콜이 사용된다.
~~~

## 인터넷 프로토콜 4계층의 캡슐화와 역캡슐화  
<image style="width: 600px" src="https://github.com/Kimpossible94/TIL/assets/80395024/ce82ab72-3823-4195-90b6-71ba3a0964ef">
  
데이터 전송시, 상위계층에서 하위계층으로 이동하고, 계층 이동마다 필요한 정보(헤더)가 추가된다.  
이를 캡슐화라고 한다.   
  
데이터 수신시, 하위계층에서 상위계층으로 이동하고, 계층 이동마다 추가된 헤더를 읽고 알맞은 행동을 취한후 헤더를 제거한다.  
이를 역캡슐화라고 한다.  

1. 프로그램이 데이터를 생성해서 OS계층에 전달
3. 전달된 메세지에 TCP 정보를 생성해서 씌움
4. TCP 정보 밖에 IP 정보를 생성해서 씌움
5. LAN 카드를 통해 전달 (이더넷 프레임을 통해 전달, MAC 주소등 물리적인 정보를 포함하고 있다.)

## TCP의 특징  
전송 제어 프로토콜  
* 연결지향 - 상대 서버와 연결이 되었는지 안되었는지 확인 후 메세지를 보낸다. (TCP 3 way handshake)
* 데이터 전달 보증
* 순서 보장
* 위의 특징으로 신뢰할 수 있는 프로토콜이며, 현재는 대부분 TCP를 사용한다.

### TCP 3 way handshake  
<image style="width: 600px" src="https://github.com/Kimpossible94/TIL/assets/80395024/63e547ba-29d3-4bfb-b974-296a705a700c">  
  
1. 클라이언트에서 서버로 연결해달라는 요청인 SYN을 보낸다.
2. 요청을 수락한다는 의미인 ACK를 보내면서 동시에 클라이언트에게 연결을 요청하는 SYN을 보낸다.
3. 마지막으로 클라이언트도 수락한다는 ACK를 보낸다.
4. 이렇게 연결을 서로 확인 후 데이터를 전송한다. (SYN을 보낸 후 응답이 없다면 데이터를 전송하지 않는다.)
*최근에는 최적화가 되어서 마지막으로 클라이언트가 ACK를 보낼 때 데이터도 전송을 한다.*  
*물리적으로 연결되었다고 하지않고, 논리적으로 연결되었다고 한다.*
  
<image style="width: 600px" src="https://github.com/Kimpossible94/TIL/assets/80395024/cfe386f0-7eee-4921-bbee-159f6173cf66">   
  
TCP 세그먼트 안에는 전송 제어, 순서, 검증 정보등이 있어서 아래와 같은 동작이 가능하다.  
  
### 데이터 전달 보증  
데이터 전송을 잘 받았는지에 대한 응답을 해주므로 데이터 전달이 잘 되었는지 알 수 있다.  

### 전달 보장  
패킷1 -> 패킷2 -> 패킷3 이렇게 보냈는데 서버에는 패킷1 -> 패킷3 -> 패킷2 이렇게 전달되었을 때,  
서버에서 검증 후 다시 전달을 요청한다.  
  
## UDP의 특징  
사용자 데이터그램 프로토콜  
* 연결지향 - TCP 3 way handshake X
* 데이터 전달 보증 X
* 순서 전달 보증 X
* 단순하고 속도가 빠름
* IP(인터넷 프로토콜)와 거의 같고, 거기에 PORT와 체크섬 정도만 추가되었다.
---

<br>



